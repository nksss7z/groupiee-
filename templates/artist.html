<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Artist.Name}} - Groupie Tracker</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        .music-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #e41212;
            color: white;
            border: none;
            padding: 12px 22px;
            border-radius: 999px;
            cursor: pointer;
            font-size: 16px;
            z-index: 9999;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            transition: transform 0.2s, background 0.2s;
        }
        .music-control:hover { transform: scale(1.05); }
        .music-control.playing { background: #700eb1; }
        
        .lang-toggle {
            position: fixed;
            top: 20px;
            right: 70px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--card-bg, #1a1d2e);
            border: 2px solid var(--primary-color, #6c63ff);
            color: var(--text-color, #fff);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        .lang-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(108, 99, 255, 0.4);
        }

        .share-btn {
            left: 20px !important;
        }
    </style>
</head>
<body>
    <!-- Musique de fond -->
    <audio id="bgMusic" loop>
        <source src="/assets/backgroundmusic.m4a" type="audio/mp4">
    </audio>
    <button id="musicBtn" class="music-control">üîá</button>

    <script>
        const music = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicBtn');
        let isPlaying = false;
        music.volume = 0.3;

        const setState = (playing) => {
            isPlaying = playing;
            musicBtn.textContent = playing ? 'üîä' : 'üîá';
            musicBtn.classList.toggle('playing', playing);
        };

        musicBtn.addEventListener('click', () => {
            if (isPlaying) {
                music.pause();
                setState(false);
            } else {
                music.play().then(() => setState(true));
            }
        });

        // Musique coup√©e par d√©faut
        setState(false);
    </script>

    <button class="theme-toggle" id="themeToggle" title="Changer de th√®me">üåô</button>
    <button class="lang-toggle" id="langBtn" title="Switch language">üá´üá∑</button>
    <button class="share-btn" title="Partager">Partager</button>
    
    <div id="artist-names" data-names="{{.Artist.Name}}|{{.Artist.Name}}|{{.Artist.Name}}" data-images="{{.Artist.Image}}|{{.Artist.Image}}|{{.Artist.Image}}" hidden></div>
    <div class="api-ribbons" aria-hidden="true">
        <div class="api-ribbon slow"></div>
        <div class="api-ribbon reverse"></div>
        <div class="api-ribbon fast"></div>
        <div class="api-ribbon reverse slow"></div>
    </div>
    <header>
        <div class="container">
            <a href="/" class="back-link">‚Üê Retour</a>
            <h1>{{.Artist.Name}}</h1>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="artist-detail">
                <div class="artist-header">
                    <div class="artist-image-large">
                        <img src="{{.Artist.Image}}" alt="{{.Artist.Name}}">
                    </div>
                    <div class="artist-info-detail">
                        <h2 class="info-title">Informations</h2>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Date de cr√©ation:</span>
                                <span class="info-value">{{.Artist.CreationDate}}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Premier album:</span>
                                <span class="info-value">{{.Artist.FirstAlbum}}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Nombre de membres:</span>
                                <span class="info-value">{{len .Artist.Members}}</span>
                            </div>
                        </div>

                        <div class="members-section">
                            <h3 class="members-title">Membres du groupe</h3>
                            <ul class="members-list">
                                {{range .Artist.Members}}
                                <li>{{.}}</li>
                                {{end}}
                            </ul>
                        </div>
                    </div>
                </div>

                {{if .Relation}}
                    <div class="map-section">
                        <h2 class="map-title">Carte des concerts</h2>
                        <div id="map"></div>
                        <div id="locations-data" style="display: none;">
                            {{range $location, $dates := .Relation.DatesLocations}}
                            <div class="location-item" data-location="{{$location}}" data-dates="{{range $index, $date := $dates}}{{if $index}},{{end}}{{$date}}{{end}}"></div>
                            {{end}}
                        </div>
                    </div>

                    <div class="concerts-section">
                        <h2 class="concerts-title">Dates de concerts</h2>
                        <div class="concerts-grid">
                            {{range $location, $dates := .Relation.DatesLocations}}
                            <div class="concert-card">
                                <h3 class="concert-location">{{$location}}</h3>
                                <ul class="concert-dates">
                                    {{range $dates}}
                                    <li>
                                        <span class="date-text">{{.}}</span>
                                        <button class="btn-book-ticket" data-location="{{$location}}" data-date="{{.}}" data-artist="{{$.Artist.Name}}" data-artist-id="{{$.Artist.ID}}">
                                            R√©server
                                        </button>
                                    </li>
                                    {{end}}
                                </ul>
                            </div>
                            {{end}}
                        </div>
                    </div>
                {{else}}
                <div class="no-concerts">
                    <p class="no-concerts-text">Aucune date de concert disponible pour le moment.</p>
                </div>
                {{end}}
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p class="footer-text">2025 Groupie Tracker - Tous droits r√©serv√©s</p>
        </div>
    </footer>

    <!-- Modal de r√©servation -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 class="modal-booking-title">R√©server des billets</h2>
            <div id="bookingDetails">
                <p><strong class="detail-artist">Artiste:</strong> <span id="modalArtist"></span></p>
                <p><strong class="detail-location">Lieu:</strong> <span id="modalLocation"></span></p>
                <p><strong class="detail-date">Date:</strong> <span id="modalDate"></span></p>
            </div>
            
            <div class="ticket-selection">
                <h3 class="select-tickets-title">S√©lectionnez vos billets</h3>
                <div class="ticket-type">
                    <label>
                        <input type="checkbox" class="ticket-checkbox" data-type="standard" data-price="50">
                        <span class="ticket-standard">Billet Standard - 50‚Ç¨</span>
                    </label>
                    <input type="number" class="ticket-quantity" data-type="standard" min="0" max="10" value="0">
                </div>
                <div class="ticket-type">
                    <label>
                        <input type="checkbox" class="ticket-checkbox" data-type="vip" data-price="150">
                        <span class="ticket-vip">Billet VIP - 150‚Ç¨</span>
                    </label>
                    <input type="number" class="ticket-quantity" data-type="vip" min="0" max="10" value="0">
                </div>
                <div class="ticket-type">
                    <label>
                        <input type="checkbox" class="ticket-checkbox" data-type="premium" data-price="250">
                        <span class="ticket-premium">Billet Premium - 250‚Ç¨</span>
                    </label>
                    <input type="number" class="ticket-quantity" data-type="premium" min="0" max="10" value="0">
                </div>
            </div>

            <div class="customer-info">
                <h3 class="customer-info-title">Vos informations</h3>
                <input type="text" id="customerName" placeholder="Nom complet" required>
                <input type="email" id="customerEmail" placeholder="Email" required>
            </div>

            <div class="total-price">
                <strong class="total-label">Total:</strong> <span id="totalPrice">0</span>‚Ç¨
            </div>

            <button id="proceedToPayment" class="btn-primary">Proc√©der au paiement</button>
        </div>
    </div>

    <!-- Modal de paiement -->
    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 class="modal-payment-title">Paiement s√©curis√©</h2>
            
            <div class="payment-info">
                <p><strong class="payment-amount-label">Montant √† payer:</strong> <span id="paymentAmount">0</span>‚Ç¨</p>
            </div>

            <div class="payment-form">
                <input type="text" id="cardNumber" placeholder="Num√©ro de carte" maxlength="16" required>
                <div class="card-details">
                    <input type="text" id="cardExpiry" placeholder="MM/AA" maxlength="5" required>
                    <input type="text" id="cardCVV" placeholder="CVV" maxlength="3" required>
                </div>
            </div>

            <button id="confirmPayment" class="btn-primary">Confirmer le paiement</button>
        </div>
    </div>

    <!-- Modal de confirmation -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 class="modal-success-title">Paiement r√©ussi!</h2>
            <div class="confirmation-message">
                <p class="confirm-booking">Votre r√©servation a √©t√© confirm√©e.</p>
                <p class="confirm-email">Un email de confirmation a √©t√© envoy√© √† <span id="confirmEmail"></span></p>
                <p><strong class="order-number-label">Num√©ro de commande:</strong> <span id="orderId"></span></p>
            </div>
            <button class="btn-primary btn-close-modal">Fermer</button>
        </div>
    </div>

    <script>
        // Syst√®me de traduction
        let currentLang = localStorage.getItem('preferredLang') || 'fr';

        const translations = {
            fr: {
                back: '‚Üê Retour',
                infoTitle: 'Informations',
                creationDate: 'Date de cr√©ation:',
                firstAlbum: 'Premier album:',
                membersCount: 'Nombre de membres:',
                membersTitle: 'Membres du groupe',
                mapTitle: 'Carte des concerts',
                concertsTitle: 'Dates de concerts',
                noConcerts: 'Aucune date de concert disponible pour le moment.',
                bookBtn: 'R√©server',
                footer: '2025 Groupie Tracker - Tous droits r√©serv√©s',
                modalBooking: 'R√©server des billets',
                modalArtist: 'Artiste:',
                modalLocation: 'Lieu:',
                modalDate: 'Date:',
                selectTickets: 'S√©lectionnez vos billets',
                standardTicket: 'Billet Standard - 50‚Ç¨',
                vipTicket: 'Billet VIP - 150‚Ç¨',
                premiumTicket: 'Billet Premium - 250‚Ç¨',
                customerInfo: 'Vos informations',
                fullName: 'Nom complet',
                email: 'Email',
                total: 'Total:',
                proceedPayment: 'Proc√©der au paiement',
                securePayment: 'Paiement s√©curis√©',
                amountToPay: 'Montant √† payer:',
                cardNumber: 'Num√©ro de carte',
                cardExpiry: 'MM/AA',
                cardCVV: 'CVV',
                confirmPayment: 'Confirmer le paiement',
                paymentSuccess: 'Paiement r√©ussi!',
                bookingConfirmed: 'Votre r√©servation a √©t√© confirm√©e.',
                emailSent: 'Un email de confirmation a √©t√© envoy√© √†',
                orderNumber: 'Num√©ro de commande:',
                close: 'Fermer',
                shareBtn: 'Partager',
                themeToggle: 'Changer de th√®me',
                langToggle: 'Changer la langue'
            },
            en: {
                back: '‚Üê Back',
                infoTitle: 'Information',
                creationDate: 'Creation date:',
                firstAlbum: 'First album:',
                membersCount: 'Number of members:',
                membersTitle: 'Band Members',
                mapTitle: 'Concert Map',
                concertsTitle: 'Concert Dates',
                noConcerts: 'No concert dates available at the moment.',
                bookBtn: 'Book',
                footer: '2025 Groupie Tracker - All rights reserved',
                modalBooking: 'Book Tickets',
                modalArtist: 'Artist:',
                modalLocation: 'Location:',
                modalDate: 'Date:',
                selectTickets: 'Select your tickets',
                standardTicket: 'Standard Ticket - ‚Ç¨50',
                vipTicket: 'VIP Ticket - ‚Ç¨150',
                premiumTicket: 'Premium Ticket - ‚Ç¨250',
                customerInfo: 'Your Information',
                fullName: 'Full name',
                email: 'Email',
                total: 'Total:',
                proceedPayment: 'Proceed to payment',
                securePayment: 'Secure Payment',
                amountToPay: 'Amount to pay:',
                cardNumber: 'Card number',
                cardExpiry: 'MM/YY',
                cardCVV: 'CVV',
                confirmPayment: 'Confirm payment',
                paymentSuccess: 'Payment successful!',
                bookingConfirmed: 'Your booking has been confirmed.',
                emailSent: 'A confirmation email has been sent to',
                orderNumber: 'Order number:',
                close: 'Close',
                shareBtn: 'Share',
                themeToggle: 'Change theme',
                langToggle: 'Switch language'
            }
        };

        function translateArtistPage(lang) {
            const t = translations[lang];
            document.documentElement.lang = lang;
            
            document.querySelector('.back-link').textContent = t.back;
            document.querySelector('.info-title').textContent = t.infoTitle;
            document.querySelector('.members-title').textContent = t.membersTitle;
            document.querySelector('.map-title').textContent = t.mapTitle;
            document.querySelector('.concerts-title').textContent = t.concertsTitle;
            document.querySelector('.footer-text').textContent = t.footer;
            document.querySelector('.share-btn').textContent = t.shareBtn;
            document.querySelector('.share-btn').title = t.shareBtn;
            document.getElementById('themeToggle').title = t.themeToggle;
            document.getElementById('langBtn').title = t.langToggle;
            
            const infoLabels = document.querySelectorAll('.info-item .info-label');
            if (infoLabels[0]) infoLabels[0].textContent = t.creationDate;
            if (infoLabels[1]) infoLabels[1].textContent = t.firstAlbum;
            if (infoLabels[2]) infoLabels[2].textContent = t.membersCount;
            
            document.querySelectorAll('.btn-book-ticket').forEach(btn => {
                btn.textContent = t.bookBtn;
            });
            
            const noConcertText = document.querySelector('.no-concerts-text');
            if (noConcertText) noConcertText.textContent = t.noConcerts;
            
            document.querySelector('.modal-booking-title').textContent = t.modalBooking;
            document.querySelector('.detail-artist').textContent = t.modalArtist;
            document.querySelector('.detail-location').textContent = t.modalLocation;
            document.querySelector('.detail-date').textContent = t.modalDate;
            document.querySelector('.select-tickets-title').textContent = t.selectTickets;
            document.querySelector('.ticket-standard').textContent = t.standardTicket;
            document.querySelector('.ticket-vip').textContent = t.vipTicket;
            document.querySelector('.ticket-premium').textContent = t.premiumTicket;
            document.querySelector('.customer-info-title').textContent = t.customerInfo;
            document.getElementById('customerName').placeholder = t.fullName;
            document.getElementById('customerEmail').placeholder = t.email;
            document.querySelector('.total-label').textContent = t.total;
            document.getElementById('proceedToPayment').textContent = t.proceedPayment;
            
            document.querySelector('.modal-payment-title').textContent = t.securePayment;
            document.querySelector('.payment-amount-label').textContent = t.amountToPay;
            document.getElementById('cardNumber').placeholder = t.cardNumber;
            document.getElementById('cardExpiry').placeholder = t.cardExpiry;
            document.getElementById('cardCVV').placeholder = t.cardCVV;
            document.getElementById('confirmPayment').textContent = t.confirmPayment;
            
            document.querySelector('.modal-success-title').textContent = t.paymentSuccess;
            document.querySelector('.confirm-booking').textContent = t.bookingConfirmed;
            const emailSentElement = document.querySelector('.confirm-email');
            if (emailSentElement) {
                const email = emailSentElement.querySelector('span').textContent;
                emailSentElement.innerHTML = t.emailSent + ' <span id="confirmEmail">' + email + '</span>';
            }
            document.querySelector('.order-number-label').textContent = t.orderNumber;
            document.querySelector('.btn-close-modal').textContent = t.close;
        }

        const langBtn = document.getElementById('langBtn');
        if (currentLang === 'en') {
            langBtn.textContent = 'üá¨üáß';
            setTimeout(() => translateArtistPage('en'), 100);
        } else {
            langBtn.textContent = 'üá´üá∑';
        }

        langBtn.addEventListener('click', () => {
            currentLang = currentLang === 'fr' ? 'en' : 'fr';
            langBtn.textContent = currentLang === 'fr' ? 'üá´üá∑' : 'üá¨üáß';
            translateArtistPage(currentLang);
            localStorage.setItem('preferredLang', currentLang);
        });
    </script>

    <script src="/static/js/ribbons.js"></script>
    <script src="/static/js/map.js"></script>
    <script src="/static/js/features.js"></script>
    <script src="/static/js/booking.js"></script>
    <script src="/static/js/bio.js"></script>
</body>
</html>