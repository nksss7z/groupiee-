<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Artist.Name}} - Groupie Tracker</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        .music-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #e41212;
            color: white;
            border: none;
            padding: 12px 22px;
            border-radius: 999px;
            cursor: pointer;
            font-size: 16px;
            z-index: 9999;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            transition: transform 0.2s, background 0.2s;
        }
        .music-control:hover { transform: scale(1.05); }
        .music-control.playing { background: #700eb1; }
        
        .music-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 9999;
        }

        .music-controls .music-control {
            position: static;
            margin: 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 10px 14px;
            font-size: 18px;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .music-controls .music-control:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .music-controls .music-control.playing {
            background: rgba(108, 99, 255, 0.2);
            border-color: rgba(108, 99, 255, 0.5);
        }
        
        

        .share-btn {
            left: 20px !important;
        }
    </style>
</head>
<body>
    <audio id="bgMusic" loop preload="auto">
        <source src="/assets/ytmp3free.cc_l2b-la-zone-youtubemp3free.org.mp3" type="audio/mpeg">
    </audio>
    <div class="music-controls">
        <button id="prevBtn" class="music-control prev-btn" title="Reculer">‚èÆÔ∏è</button>
        <button id="musicBtn" class="music-control play-btn">üîá</button>
        <button id="nextBtn" class="music-control next-btn" title="Avancer">‚è≠Ô∏è</button>
    </div>

    <script>
        const music = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        let isPlaying = false;
        let musicStarted = false;
        music.volume = 0.3;

        // Playlist
        const playlist = [
            '/assets/ytmp3free.cc_l2b-la-zone-youtubemp3free.org.mp3',
            '/assets/ytmp3free.cc_ariana-grande-ft-nicki-minaj-side-to-side-official-video-ft-nicki-minaj-youtubemp3free.org.mp3',
            '/assets/ytmp3free.cc_meryl-shatta-confessions-feat-nken-youtubemp3free.org.mp3',
            '/assets/ytmp3free.cc_sucre-sale-logobi-gt-youtubemp3free.org.mp3',
            '/assets/ytmp3free.cc_werenoi-tu-connais-speed-up-youtubemp3free.org.mp3'
        ];
        let currentTrack = 0;

        const setState = (playing) => {
            isPlaying = playing;
            musicBtn.textContent = playing ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è';
            musicBtn.classList.toggle('playing', playing);
        };

        // Fonction pour d√©marrer la musique
        const startMusic = () => {
            if (!musicStarted) {
                musicStarted = true;
                music.play().then(() => {
                    setState(true);
                }).catch(() => {
                    setState(false);
                });
            }
        };

        // D√©marrer la musique au premier clic
        document.addEventListener('click', startMusic, { once: true });
        document.addEventListener('keydown', startMusic, { once: true });
        document.addEventListener('touchstart', startMusic, { once: true });

        musicBtn.addEventListener('click', () => {
            startMusic();
            
            if (isPlaying) {
                music.pause();
                setState(false);
            } else {
                music.play().then(() => {
                    setState(true);
                });
            }
        });

        // Bouton Reculer (chanson pr√©c√©dente)
        prevBtn.addEventListener('click', () => {
            startMusic();
            currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
            music.src = playlist[currentTrack];
            music.play().then(() => setState(true));
        });

        // Bouton Avancer (chanson suivante)
        nextBtn.addEventListener('click', () => {
            startMusic();
            currentTrack = (currentTrack + 1) % playlist.length;
            music.src = playlist[currentTrack];
            music.play().then(() => setState(true));
        });
    </script>

    <button class="theme-toggle" id="themeToggle" title="Changer de th√®me">üåô</button>
    
    
    <div id="artist-names" data-names="{{.Artist.Name}}|{{.Artist.Name}}|{{.Artist.Name}}" data-images="{{.Artist.Image}}|{{.Artist.Image}}|{{.Artist.Image}}" hidden></div>
    <div class="api-ribbons" aria-hidden="true">
        <div class="api-ribbon slow"></div>
        <div class="api-ribbon reverse"></div>
        <div class="api-ribbon fast"></div>
        <div class="api-ribbon reverse slow"></div>
    </div>
    <header>
        <div class="container">
            <a href="/" class="back-link">‚Üê Retour</a>
            <h1>{{.Artist.Name}}</h1>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="artist-detail">
                <div class="artist-header">
                    <div class="artist-image-large">
                        <img src="{{.Artist.Image}}" alt="{{.Artist.Name}}">
                    </div>
                    <div class="artist-info-detail">
                        <h2 class="info-title">Informations</h2>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Date de cr√©ation:</span>
                                <span class="info-value">{{.Artist.CreationDate}}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Premier album:</span>
                                <span class="info-value">{{.Artist.FirstAlbum}}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Nombre de membres:</span>
                                <span class="info-value">{{len .Artist.Members}}</span>
                            </div>
                        </div>

                        <div class="members-section">
                            <h3 class="members-title">Membres du groupe</h3>
                            <ul class="members-list">
                                {{range .Artist.Members}}
                                <li>{{.}}</li>
                                {{end}}
                            </ul>
                        </div>
                    </div>
                </div>

                {{if .Relation}}
                    <div class="map-section">
                        <h2 class="map-title">Carte des concerts</h2>
                        <div id="map"></div>
                        <div id="locations-data" style="display: none;">
                            {{range $location, $dates := .Relation.DatesLocations}}
                            <div class="location-item" data-location="{{$location}}" data-dates="{{range $index, $date := $dates}}{{if $index}},{{end}}{{$date}}{{end}}"></div>
                            {{end}}
                        </div>
                    </div>

                    <div class="concerts-section">
                        <h2 class="concerts-title">Dates de concerts</h2>
                        <div class="concerts-grid">
                            {{range $location, $dates := .Relation.DatesLocations}}
                            <div class="concert-card">
                                <h3 class="concert-location">{{$location}}</h3>
                                <ul class="concert-dates">
                                    {{range $dates}}
                                    <li>
                                        <span class="date-text">{{.}}</span>
                                        <button class="btn-book-ticket" data-location="{{$location}}" data-date="{{.}}" data-artist="{{$.Artist.Name}}" data-artist-id="{{$.Artist.ID}}">
                                            R√©server
                                        </button>
                                    </li>
                                    {{end}}
                                </ul>
                            </div>
                            {{end}}
                        </div>
                    </div>
                {{else}}
                <div class="no-concerts">
                    <p class="no-concerts-text">Aucune date de concert disponible pour le moment.</p>
                </div>
                {{end}}
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p class="footer-text">2025 Groupie Tracker - Tous droits r√©serv√©s</p>
        </div>
    </footer>

    <!-- Modal de r√©servation -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 class="modal-booking-title">R√©server des billets</h2>
            <div id="bookingDetails">
                <p><strong class="detail-artist">Artiste:</strong> <span id="modalArtist"></span></p>
                <p><strong class="detail-location">Lieu:</strong> <span id="modalLocation"></span></p>
                <p><strong class="detail-date">Date:</strong> <span id="modalDate"></span></p>
            </div>
            
            <div class="ticket-selection">
                <h3 class="select-tickets-title">S√©lectionnez vos billets</h3>
                <div class="ticket-type">
                    <label>
                        <input type="checkbox" class="ticket-checkbox" data-type="standard" data-price="50">
                        <span class="ticket-standard">Billet Standard - 50‚Ç¨</span>
                    </label>
                    <input type="number" class="ticket-quantity" data-type="standard" min="0" max="10" value="0">
                </div>
                <div class="ticket-type">
                    <label>
                        <input type="checkbox" class="ticket-checkbox" data-type="vip" data-price="150">
                        <span class="ticket-vip">Billet VIP - 150‚Ç¨</span>
                    </label>
                    <input type="number" class="ticket-quantity" data-type="vip" min="0" max="10" value="0">
                </div>
                <div class="ticket-type">
                    <label>
                        <input type="checkbox" class="ticket-checkbox" data-type="premium" data-price="250">
                        <span class="ticket-premium">Billet Premium - 250‚Ç¨</span>
                    </label>
                    <input type="number" class="ticket-quantity" data-type="premium" min="0" max="10" value="0">
                </div>
            </div>

            <div class="customer-info">
                <h3 class="customer-info-title">Vos informations</h3>
                <input type="text" id="customerName" placeholder="Nom complet" required>
                <input type="email" id="customerEmail" placeholder="Email" required>
            </div>

            <div class="total-price">
                <strong class="total-label">Total:</strong> <span id="totalPrice">0</span>‚Ç¨
            </div>

            <button id="proceedToPayment" class="btn-primary">Proc√©der au paiement</button>
        </div>
    </div>

    <!-- Modal de paiement -->
    <div id="paymentModal" class="modal">
        <div class="modal-content payment-modal-content">
            <span class="close">&times;</span>
            <h2 class="modal-payment-title">Paiement s√©curis√©</h2>
            
            <div class="payment-transaction-info">
                <div class="transaction-header">
                    <span>Votre transaction</span>
                    <div class="security-badge">
                        <span>üîí</span>
                        <small>100% s√©curis√©</small>
                    </div>
                </div>
                <div class="transaction-details">
                    <div class="transaction-item">
                        <span class="label">Marchand</span>
                        <span class="value" id="merchantName">Groupie Tracker</span>
                    </div>
                    <div class="transaction-item">
                        <span class="label">Montant</span>
                        <span class="value amount" id="paymentAmount">0</span>‚Ç¨
                    </div>
                </div>
            </div>

            <div class="payment-form-section">
                <h3>Votre carte</h3>
                <div class="card-logos">
                    <span>üí≥ VISA</span>
                    <span>üí≥ Mastercard</span>
                    <span>üí≥ CB</span>
                </div>
                
                <div class="payment-form">
                    <div class="form-group">
                        <label for="cardholderName">Nom du titulaire</label>
                        <input type="text" id="cardholderName" placeholder="Jean Dupont" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="cardNumber">Num√©ro de carte</label>
                        <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="cardExpiry">Date d'expiration</label>
                            <input type="text" id="cardExpiry" placeholder="MM/AA" maxlength="5" required>
                        </div>
                        <div class="form-group">
                            <label for="cardCVV">CVV</label>
                            <input type="text" id="cardCVV" placeholder="123" maxlength="3" required>
                        </div>
                    </div>
                </div>

                <button id="confirmPayment" class="btn-pay">Payer <span id="payAmount">0</span>‚Ç¨</button>
                
                <div class="payment-footer">
                    <small>Vos donn√©es sont chiffr√©es et s√©curis√©es</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirmation -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 class="modal-success-title">Paiement r√©ussi!</h2>
            <div class="confirmation-message">
                <p class="confirm-booking">Votre r√©servation a √©t√© confirm√©e.</p>
                <p class="confirm-email">Un email de confirmation a √©t√© envoy√© √† <span id="confirmEmail"></span></p>
                <p><strong class="order-number-label">Num√©ro de commande:</strong> <span id="orderId"></span></p>
            </div>
            <button class="btn-primary btn-close-modal">Fermer</button>
        </div>
    </div>

    

    <script src="/static/js/ribbons.js"></script>
    <script src="/static/js/map.js"></script>
    <script src="/static/js/features.js"></script>
    <script src="/static/js/booking.js"></script>
    <script src="/static/js/bio.js"></script>
</body>
</html>